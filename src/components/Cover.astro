---
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faChevronDown } from "@fortawesome/free-solid-svg-icons";
import { joinClasses } from "../utils/joinClasses";
import { Image } from "astro:assets";
type Props = {
  classes: string;
  styles: string;
  url?: string;
  height?: number;
  width?: number;
  dimRatio?: number;
  overlayColor?: string;
  customOverlayColor?: string;
  minHeight?: number;
  minHeightUnit?: string;
  id: string;
};

const {
  classes,
  styles,
  url,
  height,
  width,
  dimRatio = 50,
  overlayColor,
  customOverlayColor,
  minHeight,
  minHeightUnit,
  id,
} = Astro.props;

let minHeightValue = "";
if (minHeight && minHeightUnit) {
  minHeightValue = `min-height: ${minHeight}${minHeightUnit}`;
}

let overlayStyle = "";
if (customOverlayColor) {
  overlayStyle = `background: ${customOverlayColor}`;
}

if (overlayColor) {
  overlayStyle = `background: var(--color--${overlayColor})`;
}
const request = new URL(Astro.request.url);
// Utilisez `pathname` pour v√©rifier si c'est la page d'accueil
const isHomePage = request.pathname === "/";
const isPostPage = request.pathname === "/actualites/";
const isCabinetPage = request.pathname === "/le-cabinet/";
---

<div
  class={joinClasses(classes, "relative !min-h-0 overflow-hidden")}
  style={styles}
>
  {
    !!url && (
      <Image
        class=" z-30 absolute w-full object-cover h-full !max-w-full rounded-br-[250px] sm:rounded-br-[427px]"
        height={height || 1000}
        width={width || 1000}
        src={url}
        alt=""
        widths={[240, 540, 720, width || 1000]}
        id={id}
        quality="low"
        loading="eager"
      />
    )
  }
  {
    !!isHomePage && (
      <div class="absolute bottom-8 z-40 text-blue-light text-center left-1/2 -translate-x-1/2 flex-col flex">
        <button type="button" class="">
          ENTRER
        </button>
        <FontAwesomeIcon className="text-xs pl-1" icon={faChevronDown} />
      </div>
    )
  }

  <div
    class=`absolute bottom-1/2 translate-y-1/2 z-40 left-1/2 -translate-x-1/2 flex-col flex ${isHomePage ? "w-5/12" : "w-3/12"} `
  >
    <svg
      id="Calque_2"
      data-name="Calque 2"
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 570 347"
    >
      <defs>
        <style>
          .cls-1 {
            fill: rgba(255, 255, 255, 0.2);
            stroke-width: 0px;
          }
        </style>
      </defs>
      <g id="Calque_2-2" data-name="Calque 2">
        <g>
          <path
            class="cls-1"
            d="M.16,267.26c.9-8.95,5.52-16.08,13.93-21.46,17.98-9.56,39.67-13.12,65.13-10.76,25.46,2.39,51.69,9.27,78.62,20.61,26.97,11.04,51.54,24.64,73.69,40.72,22.15,16.15,38.93,32.99,50.34,50.63-19.82-17.64-44.66-31.06-74.61-40.3-30.24-9.56-60.37-15.4-90.32-17.45-29.94-2.11-54.82-.61-74.58,4.46-15.28,3.27-26.35,1.92-33.22-4.06-6.9-5.93-9.91-13.42-8.99-22.38Z"
          ></path>
          <path
            class="cls-1"
            d="M473.72,103.43c2.7,15.5-.45,30.75-9.45,45.64-5.37,7.76-16.75,20.3-34.12,37.6-17.4,17.03-36.41,35.1-57.09,54.18-20.68,18.84-38.51,35.1-53.45,48.8-15,13.45-22.92,20.48-23.84,21.06.31-.88,3.28-11.04,8.98-30.42,5.71-19.41,12.74-42.4,21.14-68.97,8.37-26.88,16.63-51.79,24.69-74.78,8.07-22.96,14.54-38.49,19.3-46.53,9.6-14.67,22.06-24.03,37.34-28.25,14.95-4.47,29.21-2.69,42.68,5.38,13.16,8.96,21.1,21.04,23.8,36.29Z"
          ></path>
          <path
            class="cls-1"
            d="M245.93,17.88c10.19-11.65,23.19-17.61,39.09-17.88,15.86.27,29.05,6.24,39.54,17.88,10.46,11.65,15.86,26.29,16.14,43.88-.27,9.26-3.1,25.83-8.53,49.71-5.68,23.57-12.09,48.95-19.3,76.13-7.21,26.87-13.63,50.17-19.33,69.85-5.37,19.39-8.22,29.57-8.53,30.42-.28-.78-2.69-9.58-7.27-26.27l-1.26-4.61c-5.71-19.42-12.15-42.53-19.33-69.4-7.18-27.18-13.65-52.56-19.33-76.13-5.37-23.88-8.22-40.45-8.53-49.71.58-17.59,6.13-32.23,16.63-43.88Z"
          ></path>
          <path
            class="cls-1"
            d="M265.23,280.29c5.71,19.39,8.69,29.54,8.99,30.42-.58-.58-8.53-7.62-23.78-21.06-15-13.7-32.82-29.96-53.5-48.8-20.65-19.07-39.51-37.15-56.6-54.18-17.36-17.3-28.78-29.83-34.15-37.6-8.98-14.89-12.15-30.15-9.45-45.64,2.4-15.25,10.19-27.33,23.38-36.29,13.5-7.76,27.86-9.54,43.1-5.38,15,4.22,27.28,13.57,36.87,28.25,5.1,8.04,11.54,23.57,19.3,46.53,8.1,22.99,16.33,47.91,24.73,74.78,8.37,26.56,15.43,49.56,21.1,68.97Z"
          ></path>
          <path
            class="cls-1"
            d="M453.04,289.25c29.98-2.11,54.83-.61,74.58,4.46,15.28,3.27,26.36,1.92,33.26-4.06,6.9-5.93,9.88-13.42,8.95-22.38-.58-8.95-5.06-16.08-13.46-21.46-17.98-9.56-39.86-13.12-65.56-10.76-25.49,2.39-51.66,9.27-78.63,20.61-26.96,11.04-51.54,24.64-73.71,40.72-22.16,16.15-38.94,32.99-50.29,50.63,19.76-17.64,44.79-31.06,75.01-40.3,29.97-9.56,59.92-15.4,89.85-17.45Z"
          ></path>
        </g>
      </g>
    </svg>
  </div>

  <div
    class="z-30 absolute top-0 right-0 bottom-0 left-0 bg-black !max-w-full !mt-0 rounded-br-[250px] sm:rounded-br-[427px]"
    style={`opacity:${dimRatio / 100}; ${overlayStyle}`}
  >
  </div>
  <div
    style={minHeightValue}
    class="z-40 relative !mt-0 min-h-[430px] flex flex-col justify-center gap-4"
  >
    <slot />
  </div>
  <div
    class="z-20 w-full h-full absolute bg-blue-med -right-10 sm:-right-12 bottom-0 rounded-br-[250px] sm:rounded-br-[427px]"
  >
  </div>
  <div
    class="-z-10 w-full h-full absolute bg-blue-light -right-16 sm:-right-24 bottom-0 rounded-br-[250px] sm:rounded-br-[427px]"
  >
  </div>
  {
    !!isPostPage && (
      <div class="-z-20 right-0 w-full h-full absolute bg-grey-light bottom-0" />
    )
  }
  {
    !!isCabinetPage && (
      <div class="-z-20 right-0 w-full h-full absolute bg-blue-sky bottom-0" />
    )
  }
</div>
