import{j as r}from"./jsx-runtime.Biu9vCfE.js";import{r as o}from"./index.CSLRt44l.js";function T({formId:f,formMarkup:p}){const[h,i]=o.useState(!1),[v,x]=o.useState(""),[S,c]=o.useState(!1),[d,u]=o.useState(""),[b,w]=o.useState(""),t=o.useRef(null);return o.useEffect(()=>{const g=async n=>{n.preventDefault(),c(!1),u(""),t.current?.querySelectorAll(".form-error")?.forEach(e=>e.remove());try{if(t?.current){const e=t.current.getElementsByTagName("form")?.[0];if(e){const M=new FormData(e),s=await(await fetch(`http://gaia-bertholet-avocat.local/wp-json/contact-form-7/v1/contact-forms/${f}/feedback`,{method:"POST",body:M})).json();s.status==="mail_sent"?(i(!0),x(s.message),setTimeout(()=>{i(!1)},4e3),e.reset()):s.status==="validation_failed"?(s.invalid_fields.length>0&&(c(!0),w(s.message)),i(!1),s.invalid_fields.forEach(l=>{const a=e.querySelector(`[name="${l.field}"]`);if(a){let E=l.message;if(l.field==="quiz-672"&&a.value===""&&(E="Vous n’avez pas répondu au quiz."),a.parentNode){const m=document.createElement("div");m.textContent=E,m.className="form-error",a.parentNode.insertBefore(m,a.nextSibling)}}else console.warn(`Element not found for field: ${l.field}`)})):s.status==="acceptance_missing"&&(c(!0),u(s.message))}}}catch(e){console.error("Error submitting form:",e),c(!0),u("Une erreur est survenue lors de l'envoi du formulaire.")}};if(t?.current){const n=t.current.getElementsByTagName("form")?.[0];if(n)return n.addEventListener("submit",g),()=>n.removeEventListener("submit",g)}},[f,t]),r.jsxs(r.Fragment,{children:[h&&r.jsx("div",{className:"bg-green-600 p-4 text-white font-bold",children:r.jsx("p",{children:v})}),S&&r.jsx("div",{className:"bg-red-600 p-4 my-4 rounded-md text-white font-bold",children:r.jsx("p",{children:d||b})}),r.jsx("div",{className:"max-w-[--content-size] mx-auto",ref:t,dangerouslySetInnerHTML:{__html:p}})]})}export{T as default};
